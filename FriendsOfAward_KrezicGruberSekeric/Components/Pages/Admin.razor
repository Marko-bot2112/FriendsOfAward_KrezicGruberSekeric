@page "/admin"
@rendermode InteractiveServer
@inject NavigationManager Nav
@inject Blazored.Toast.Services.IToastService toastService

<BlazoredToasts></BlazoredToasts>

<div class="admin-grid">

    <div class="admin-tile blue" @onclick="() => SelectSection(AdminSection.Vote)">
        <h2>Abstimmung</h2>
        <p>Starten / Stoppen / Zurücksetzen</p>
    </div>

    <div class="admin-tile green" @onclick="() => SelectSection(AdminSection.QR)">
        <h2>QR-Codes</h2>
        <p>Codes generieren</p>
    </div>

    <div class="admin-tile orange" @onclick="() => SelectSection(AdminSection.Excel)">
        <h2>Excel Export</h2>
        <p>Export Optionen</p>
    </div>

    <div class="admin-tile red" @onclick="() => SelectSection(AdminSection.Security)">
        <h2>Sicherheit</h2>
        <p>Passwort ändern</p>
    </div>

</div>

@if (activeSection != AdminSection.None)
{
    <div class="admin-content">

        <h2 class="section-title">@GetSectionTitle()</h2>

        <div class="detail-grid">

            @if (activeSection == AdminSection.Vote)
            {
                <div class="detail-card blue">
                    <h3>Abstimmung starten</h3>
                    <p>Öffnet die Abstimmung für alle Teilnehmer.</p>
                    <button class="detail-button" @onclick="btn_startVote">Starten</button>
                </div>

                <div class="detail-card blue">
                    <h3>Abstimmung stoppen</h3>
                    <p>Beendet die laufende Abstimmung.</p>
                    <button class="detail-button" @onclick="btn_stopVote">Stoppen</button>
                </div>

                <div class="detail-card danger">
                    <h3>Alle Bewertungen löschen</h3>
                    <p>⚠️ Diese Aktion kann nicht rückgängig gemacht werden.</p>
                    <button class="detail-button danger" @onclick="btn_deleteAllReviews">
                        Löschen
                    </button>
                </div>
            }

            @if (activeSection == AdminSection.QR)
            {
                <div class="detail-card green">
                    <h3>QR-Codes generieren</h3>
                    <p>Anzahl der zu erstellenden QR-Codes</p>

                    <input class="qr-input"
                           type="number"
                           min="1"
                           @bind="qrCode_count" />

                    <button class="detail-button" @onclick="() => btn_qrcodesgenerate(qrCode_count)">
                        Generieren
                    </button>
                </div>
            }

            @if (activeSection == AdminSection.Excel)
            {
                <div class="detail-card orange">
                    <h3>Excel Export</h3>
                    <p>Exportiert alle Daten als Excel-Datei.</p>
                    <button class="detail-button" @onclick="btn_excelExportOptions">
                        Export starten
                    </button>
                </div>
            }

            @if (activeSection == AdminSection.Security)
            {
                <div class="detail-card red">
                    <h3>Passwort ändern</h3>
                    <p>Aus Sicherheitsgründen regelmäßig ändern.</p>
                    <button class="detail-button" @onclick="btn_changePassword">
                        Passwort ändern
                    </button>
                </div>
            }

        </div>
    </div>
}

@code {
    private int qrCode_count = 1;

    private AdminSection activeSection = AdminSection.None;

    private void SelectSection(AdminSection section)
    {
        activeSection = section;
    }

    private string GetSectionTitle() => activeSection switch
    {
        AdminSection.Vote => "Abstimmung verwalten",
        AdminSection.QR => "QR-Codes",
        AdminSection.Excel => "Excel Export",
        AdminSection.Security => "Sicherheit",
        _ => ""
    };

    enum AdminSection
    {
        None,
        Vote,
        QR,
        Excel,
        Security
    }

    private void btn_startVote()
    {
        toastService.ShowInfo("Abstimmumng starten ist noch nicht implementiert.");
    }
    private void btn_stopVote()
    {
        toastService.ShowInfo("Abstimmung stoppen ist noch nicht implementiert.");
    }
    private void btn_deleteAllReviews()
    {
        toastService.ShowWarning("Alle Bewertungen löschen ist noch nicht implementiert.");
    }
    private void btn_qrcodesgenerate(int count)
    {


    }
    private void btn_changePassword()
    {
        toastService.ShowInfo("Passwort ändern ist noch nicht implementiert.");
    }
    private void btn_excelExportOptions() { }
}
